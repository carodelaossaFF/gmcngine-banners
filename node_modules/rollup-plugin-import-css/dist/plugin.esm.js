/* Copyright (c) 2021 Outwalk Studios */
import{createFilter as e}from"@rollup/pluginutils";import r from"fs";import t from"path";export default(n={})=>{n.transform||(n.transform=e=>e);const a=n.alwaysOutput||!1,i=[],o=["**/*.css"].concat(n.include||[]),l=e(o,n.exclude||[]);return{name:"import-css",load(e){if(l(e))return r.readFileSync(e,"utf8")},transform(e,r){if(!l(r))return;const t=n.minify?n.transform(e).replace(/\/\*(?:(?!\*\/)[\s\S])*\*\/|[\r\n\t]+/g,"").replace(/ {2,}/g," ").replace(/ ([{:}]) /g,"$1").replace(/([{:}]) /g,"$1").replace(/([;,]) /g,"$1").replace(/ !/g,"!"):n.transform(e);return i[r]=t,{code:`export default ${JSON.stringify(t)};`,map:{mappings:""}}},generateBundle(e,n){for(let o in n){let l=Array.isArray(n[o].modules)?n[o].modules:Object.getOwnPropertyNames(n[o].modules),s=Object.entries(i).sort((e,r)=>l.indexOf(e[0])-l.indexOf(r[0])).map(e=>{if(!n[o].modules[e[0]])return e[1]}).join("\n");if(s.trim().length<=0&&!a)return;r.writeFileSync(e.output||t.join(t.dirname(e.file),t.basename(o,t.extname(e.file))+".css"),s)}}}};
